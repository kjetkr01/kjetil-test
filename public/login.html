<!DOCTYPE html>
<html>

<head>
   <title>Logg inn</title>

   <meta charset="utf-8" />

   <!-- manifest -->

   <link rel="manifest" href="manifest.json">

   <meta name="mobile-web-app-capable" content="yes">
   <meta name="apple-mobile-web-app-capable" content="yes">
   <meta name="application-name" content="Treningsstatistikken">
   <meta name="apple-mobile-web-app-title" content="Treningsstatistikken">
   <meta name="msapplication-starturl" content="/">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=0">

   <link rel="icon" type="image/png" sizes="192x192" href="images/appIcon.png">
   <link rel="apple-touch-icon" type="image/png" sizes="192x192" href="images/appIcon.png">

   <!-- -->

   <!-- status bar color -->

   <meta id="themeColor" name="theme-color" content="#357F9B">
   <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

   <!-- -->

   <link rel="stylesheet" href="styles/global/globalVariables.css">
   <link rel="stylesheet" href="styles/global/globalClasses.css">
   <link rel="stylesheet" href="styles/global/global.css">

   <!-- themeStyleCSS -->
   <!--<link id="themeStyleCSS-default" rel="stylesheet" href="styles/themes/default.css">
   <link id="themeStyleCSS-blue" rel="stylesheet" href="styles/themes/blue.css">-->
   <!-- themeStyleCSS -->
   <link id="themeStyleCSS-blue" rel="stylesheet" href="styles/themes/themes.css">

   <link rel="stylesheet" href="styles/themes/globalThemeValues.css">

   <link rel="stylesheet" href="styles/login/desktop.css">
   <link rel="stylesheet" href="styles/login/mobile.css">
   <link rel="stylesheet" href="styles/login/common.css">

   <script src="ts_application.js" type="text/javascript"></script>
   <script src="scripts/appInfo.js" type="text/javascript"></script>
   <script src="scripts/global.js" type="text/javascript"></script>
   <script src="scripts/validate/validateInfo.js" type="text/javascript"></script>

</head>

<body>

   <script>changeColorTheme();</script>

   <section id="page">

      <div id="c1r2"></div>
      <div id="c2r2"></div>
      <div id="c3r2"></div>
      <div id="c4r2"></div>
      <div id="c5r2"></div>
      <div id="c6r2"></div>
      <div id="c7r2"></div>
      <div id="c8r2"></div>
      <div id="c9r2"></div>
      <div id="c10r2"></div>

      <div id="Gtitle">
         <p id="title" class="noselect">
            Logg inn
         </p>
      </div>

      <div id="GsmallTitle">
         <p id="smallTitle" class="noselect">

         </p>
      </div>

      <div id="Glogo">
         <img id="logo" src="" alt="" draggable="false" class="noselect"></img>
      </div>

      <script>
         document.getElementById("logo").src = application.logoURL || "";
      </script>

      <div id="Gline">
         <hr id="line" class="noselect">
      </div>

      <div id="Ginp1">
         <input id="inp1" placeholder="Brukernavn" autocapitalize="none" maxlength="20" type="text" required>
         </input>
      </div>

      <div id="Ginp2">
         <input id="inp2" placeholder="Passord" maxlength="20" type="password" required>
         </input>
      </div>

      <div id="GrmbrMeBtn">
         <input id="rmbrMeBtn" type="checkbox" class="noselect">
         </input>
      </div>

      <div id="GrmbrMeTxt">
         <p id="rmbrMeTxt" class="noselect">
            Husk meg i 30 dager
         </p>
      </div>

      <div id="GrespMsg">
         <p id="respMsg">
         </p>
      </div>

      <div id="GloginBtn">
         <button id="loginBtn" class="noselect pointer" onclick="loginUser();">
            Logg inn
         </button>
      </div>

      <div id="GnoAccBtn">
         <p id="noAccBtn" class="noselect">
            <a href="access.html">Ingen konto? <strong>Be om tilgang</strong></a>
            <br>
            <button onClick="deleteCachesAndUnregisterSW();">TÃ¸m cache</button>
         </p>
      </div>

   </section>

</body>

<script>

   const cachedUsername = sessionStorage.getItem("cachedUsername");

   if (cachedUsername && cachedUsername !== "null" && cachedUsername !== "undefined") {
      document.getElementById("inp1").value = cachedUsername;
   }

   document.getElementById("smallTitle").innerHTML = application.name || "";

   /* change user color theme? */

   //const themeColor = "#357F9B";

   //document.getElementById("themeColor").content = themeColor;

   /*document.getElementById("page").addEventListener('touchmove', function (evt) {
      evt.preventDefault();
   })*/

   lockBodyPosition();

   addEventListener("keypress", function (evt) {

      if (evt.keyCode === 13) {
         loginUser();
      }

   });

   async function loginUser() {

      const rmbrMe = document.getElementById("rmbrMeBtn").checked;

      const username = document.getElementById("inp1").value;
      const psw = document.getElementById("inp2").value;

      if (username && psw) {

         const resp = await login(username, psw, rmbrMe);

         if (resp === "Login successful") {
            redirectToFeed();
         } else {
            const respmsg = document.getElementById("respMsg");
            respmsg.innerHTML = resp;
         }
      }
   };

</script>

</html>